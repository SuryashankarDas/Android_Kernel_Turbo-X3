language: c

# OS
sudo: required
dist: trusty
group: stable

before_install:
  - sudo apt-get update -y
  - sudo apt-get install libncurses5-dev
  - sudo apt-get install git-core gnupg gcc-multilib flex bison gperf build-essential zip curl libc6-dev libncurses5-dev:i386 x11proto-core-dev libx11-dev:i386 libreadline6-dev:i386 libgl1-mesa-glx:i386 libgl1-mesa-dev g++-multilib tofrodos python-markdown libxml2-utils xsltproc zlib1g-dev:i386
  - sudo ln -s /usr/lib/i386-linux-gnu/mesa/libGL.so.1 /usr/lib/i386-linux-gnu/libGL.so
  -  sudo apt-get install -y ccache &&echo 'export PATH=\"/usr/lib/ccache:$PATH\"' | tee -a ~/.bashrc &&source ~/.bashrc && echo $PATH
  - export USE_CCACHE=1

before_script:
# Download the toolchain
  - git clone "https://bitbucket.org/uberroms/aarch64-linux-android-6.x.git" "$HOME/android_prebuilt_toolchains"

# Download the Kernel Sources
  - git clone --depth=50 --branch=stock-upstream https://github.com/SuryashankarDas/Android_Kernel_Turbo-X3 $HOME/mt6795

script:
  - export KBUILD_BUILD_USER="sdas"
  - export KBUILD_BUILD_HOST="travis"
  - export ARCH=arm64
  - export CROSS_COMPILE="$HOME/android_prebuilt_toolchains/bin/aarch64-linux-android-"
  - export STRIP="$HOME/android_prebuilt_toolchains/bin/aarch64-linux-android-"
  - cd $HOME/mt6795
  - mkdir $PWD/out
  - make -C $PWD O=$PWD/out x500_defconfig
  - make -j16 -C $PWD O=$PWD/out KCFLAGS=-mno-android
  
  
